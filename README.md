1) The operation and the SM check should be atomic. Currently, they are not. Let us assume no interleavings happen between them now.
2) The control is hardcoded. 


